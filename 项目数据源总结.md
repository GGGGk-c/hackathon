# 🛰️ 卫星威胁检测系统 - 数据源总结

## 📊 数据源状态一览

### ✅ 真实数据（已集成）

| 数据类型 | 数据源 | 文件位置 | API | 状态 |
|---------|--------|---------|-----|------|
| 🌍 Kp地磁指数 | NOAA | `public/data/boulder_k_index_1m.json` | SWPC | ✅ 已集成 |
| ☀️ 太阳射电通量 | NOAA | `public/data/solar-radio-flux.json` | SWPC | ✅ 已集成 |
| ⚡ 太阳耀斑概率 | NOAA | `public/data/solar_probabilities.json` | SWPC | ✅ 已集成 |
| 🛰️ 碰撞预警(CDM) | Space-Track.org | - | REST API | ✅ 已集成 |
| 🌐 TLE轨道数据 | Space-Track.org | - | REST API | ✅ 已集成 |

### 🟡 模拟数据（回退/演示用）

| 数据类型 | 用途 | 状态 |
|---------|------|------|
| 🪨 空间碎片 | 演示/回退 | 🟡 模拟 |
| 💥 CME事件 | 演示/回退 | 🟡 模拟 |
| 🎲 随机威胁 | 演示/回退 | 🟡 模拟 |

---

## 🎯 系统功能

### 1️⃣ 空间天气监控 ✅

**数据源**：NOAA Space Weather Prediction Center

**功能**：
- ✅ 实时Kp地磁指数
- ✅ 太阳风速度（基于Kp计算）
- ✅ 太阳射电通量（2.8 GHz）
- ✅ 24小时耀斑概率（C/M/X级）
- ✅ 粒子通量估算
- ✅ 活动等级评估（Quiet/Active/Storm）

**服务**：`src/services/realSpaceWeatherService.ts`

**更新频率**：每30秒

**数据文件**：
- `public/data/boulder_k_index_1m.json` (1,441条记录)
- `public/data/solar-radio-flux.json` (1,000+条记录)
- `public/data/solar_probabilities.json` (90天预测)

---

### 2️⃣ 碰撞检测系统 ✅

**数据源**：Space-Track.org CDM

**功能**：
- ✅ 未来7天碰撞预警
- ✅ 真实碰撞概率
- ✅ 错过距离（米级精度）
- ✅ 目标物体识别
- ✅ 严重程度自动评估
- ✅ 建议行动生成

**服务**：
- `src/services/spaceTrackService.ts` (API客户端)
- `src/services/conjunctionDataService.ts` (威胁处理)

**需要配置**：
- Space-Track.org账号（免费）
- 环境变量（`.env`文件）
- 卫星NORAD ID

**更新频率**：每10秒检查

**缓存时长**：5分钟

---

### 3️⃣ 威胁监控面板 ✅

**组件**：`src/components/ThreatMonitor.tsx`

**功能**：
- ✅ 实时威胁显示
- ✅ 多威胁类型支持
  - 碰撞预警（真实）
  - 太阳风暴（真实）
  - 空间碎片（模拟）
  - CME事件（模拟）
- ✅ 数据源指示器
  - 🟢 Real Data = 使用真实数据
  - 🟡 Simulated = 使用模拟数据
- ✅ 威胁去重机制
- ✅ 智能威胁限制（最多10个）

---

### 4️⃣ 3D可视化 🌍

**组件**：`src/components/SatelliteVisualization.tsx`

**显示内容**：
- 🌍 地球（蓝色大球体）- 半径1.0
- 🛰️ 卫星（小点）- 半径0.05
- 🎯 轨道路径
- 🎨 状态颜色编码
  - 🟢 绿色 = 正常
  - 🟡 黄色 = 警告
  - 🔴 红色 = 危险

**交互**：
- 🖱️ 左键拖动：旋转
- 🖱️ 右键拖动：平移
- 🖱️ 滚轮：缩放

---

## 🔧 配置说明

### 环境变量（`.env`）

```env
# Space-Track.org 凭据
VITE_SPACETRACK_USERNAME=你的用户名
VITE_SPACETRACK_PASSWORD=你的密码

# 数据模式
VITE_USE_SIMULATION=false  # false=真实数据, true=模拟数据
```

### 配置文件（`src/config/api.config.ts`）

```typescript
// 控制数据源
export const USE_SIMULATION = false  // 改为false使用真实数据

// 更新频率
export const UPDATE_INTERVALS = {
  spaceWeather: 5000,   // 5秒
  threats: 10000,       // 10秒
  positions: 1000,      // 1秒
}

// 缓存时长
export const CACHE_DURATION = {
  spaceWeather: 60000,   // 1分钟
  conjunction: 300000,   // 5分钟
  tle: 3600000,          // 1小时
}
```

---

## 📈 数据流程

### 空间天气数据流

```
应用启动
   ↓
realSpaceWeatherService.loadData()
   ↓
读取 public/data/ 中的JSON文件
   ↓
解析最新数据点
   ↓
每30秒自动更新
   ↓
SpaceWeatherPanel 显示
```

### 碰撞检测数据流

```
应用启动
   ↓
USE_SIMULATION? ──YES→ 使用模拟数据
   ↓ NO
spaceTrackService.authenticate()
   ↓
每10秒执行检查
   ↓
checkConjunctionThreats(satellite, noradId)
   ↓
fetchConjunctionData(noradId, 7天)
   ↓
解析CDM数据
   ↓
评估严重程度
   ↓
生成威胁对象
   ↓
ThreatMonitor 显示
```

---

## 🎓 使用建议

### 开发/测试环境
```typescript
USE_SIMULATION = true  // 使用模拟数据
```
- ✅ 不需要网络
- ✅ 不需要API账号
- ✅ 威胁更频繁（便于测试）
- ✅ 立即响应

### 生产/演示环境
```typescript
USE_SIMULATION = false  // 使用真实数据
```
- ✅ 真实的碰撞预警
- ✅ 真实的空间天气
- ✅ 可信的风险评估
- ⚠️ 需要Space-Track账号
- ⚠️ 威胁较少（真实情况）

---

## 📚 文档索引

| 文档 | 内容 | 适用人群 |
|------|------|---------|
| `如何使用真实数据.md` | 空间天气数据集成 | 已集成，查看参考 |
| `真实碰撞检测数据集成指南.md` | 完整的碰撞检测指南 | 深入了解 |
| `REAL_DATA_QUICK_START.md` | 5分钟快速启动 | 新手快速上手 |
| `ENV_CONFIG_TEMPLATE.txt` | 环境变量模板 | 配置参考 |
| `卫星参数填写指南.md` | 轨道参数说明 | 添加卫星时参考 |

---

## 🆚 真实 vs 模拟对比

### 空间天气

| 特性 | 真实数据 | 模拟数据 |
|------|---------|---------|
| Kp指数 | ✅ NOAA测量 | ❌ 随机波动 |
| 太阳风速度 | ✅ 基于真实Kp | ❌ 随机生成 |
| 耀斑概率 | ✅ NOAA预测 | ❌ 无预测 |
| 射电通量 | ✅ 真实观测 | ❌ 无数据 |
| 更新来源 | JSON文件 | 随机算法 |

### 碰撞检测

| 特性 | 真实数据 | 模拟数据 |
|------|---------|---------|
| CDM数据 | ✅ Space-Track | ❌ 随机生成 |
| 碰撞概率 | ✅ 真实计算 | ❌ 随机值 |
| 目标物体 | ✅ 真实ID/名称 | ❌ 虚构ID |
| 时间准确性 | ✅ 精确TCA | ❌ 随机时间 |
| 距离准确性 | ✅ 米级精度 | ❌ 随机距离 |
| 威胁频率 | 取决于实际情况 | 每10秒15%概率 |

---

## 🔐 API限制

### NOAA Space Weather
- 无需认证
- 无速率限制（合理使用）
- 建议：60请求/分钟

### Space-Track.org
- 需要免费账号
- 限制：20请求/分钟，200请求/小时
- 自动缓存（5分钟）
- Cookie认证（2小时有效期）

---

## ✅ 快速检查清单

### 空间天气数据
- [x] 数据文件在 `public/data/` 目录
- [x] `realSpaceWeatherService.ts` 已创建
- [x] `SpaceWeatherPanel` 显示"Real Data"
- [x] Kp指数来自真实数据
- [x] 每30秒自动更新

### 碰撞检测数据
- [x] `spaceTrackService.ts` 已创建
- [x] `conjunctionDataService.ts` 已更新
- [x] `ThreatMonitor` 支持真实数据
- [x] 数据源指示器已添加
- [x] 环境变量模板已创建

### 配置
- [ ] 注册Space-Track.org账号（如需真实碰撞数据）
- [ ] 创建 `.env` 文件
- [ ] 设置 `USE_SIMULATION = false`
- [ ] 为卫星添加NORAD ID

---

## 🎉 完成状态

### ✅ 已实现
1. ✅ 真实空间天气数据
2. ✅ 真实碰撞检测数据
3. ✅ 双模式支持（真实/模拟）
4. ✅ 数据源指示器
5. ✅ 自动认证和缓存
6. ✅ 错误处理和回退
7. ✅ 完整文档

### 🔜 可扩展功能
- 🔜 ESA DISCOS空间碎片数据
- 🔜 NOAA DONKI CME数据
- 🔜 实时TLE更新
- 🔜 历史数据图表
- 🔜 WebSocket实时推送
- 🔜 多卫星批量查询

---

## 📞 需要帮助？

### 查看日志
打开浏览器开发者工具（F12）→ Console

**成功标志**：
```
✅ Space-Track authentication successful
✅ Real space weather data loaded successfully
✅ Found 3 conjunction(s) for ISS
```

**问题标志**：
```
❌ Space-Track authentication failed: 401
⚠️ Cannot fetch CDM data without authentication
⚠️ Space-Track credentials not configured
```

### 常见问题
1. **显示Simulated** → 检查配置和凭据
2. **没有威胁** → 正常，真实威胁较少
3. **认证失败** → 验证Space-Track凭据
4. **CORS错误** → 需要配置代理

---

## 🚀 开始使用

1. **查看空间天气**：已自动工作！
2. **启用碰撞检测**：阅读 `REAL_DATA_QUICK_START.md`
3. **添加卫星**：使用真实NORAD ID
4. **监控威胁**：查看Threat Monitor

**推荐测试卫星**：
- ISS (国际空间站): NORAD ID `25544`
- Hubble (哈勃望远镜): NORAD ID `20580`
- Tiangong (天宫空间站): NORAD ID `48274`

---

**项目状态**：✅ 生产就绪

**数据质量**：⭐⭐⭐⭐⭐ 来自NOAA和Space-Track.org

**最后更新**：2025-10-25





