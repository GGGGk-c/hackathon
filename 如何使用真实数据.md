# 🌟 真实空间天气数据集成指南

## ✅ 已完成

我已经成功将您提供的3个真实NOAA数据文件集成到应用中！

### 📁 数据文件位置

```
public/data/
├── boulder_k_index_1m.json      # Kp地磁指数数据
├── solar-radio-flux.json        # 太阳射电通量数据
└── solar_probabilities.json     # 太阳耀斑概率预测
```

### 🔧 新增功能

#### 1. 真实数据服务 (`src/services/realSpaceWeatherService.ts`)

**功能**：
- ✅ 读取NOAA的Kp指数实时数据
- ✅ 读取太阳射电通量(2.8 GHz)
- ✅ 读取太阳耀斑概率预测
- ✅ 自动计算太阳风速度
- ✅ 估算质子和电子通量
- ✅ 危险等级评估

**API方法**：
```typescript
// 加载数据
await realSpaceWeatherService.loadData()

// 获取当前天气
const weather = realSpaceWeatherService.getCurrentWeather()

// 获取Kp历史数据
const history = realSpaceWeatherService.getKpHistory(24) // 最近24小时

// 检查是否危险
const dangerous = realSpaceWeatherService.isDangerous()

// 获取威胁等级
const level = realSpaceWeatherService.getThreatLevel()
```

#### 2. 更新的空间天气面板

**新增显示**：
- 🟢 **实时数据指示器**：显示"Real Data"（绿色）或"Simulated"（黄色）
- 📡 **太阳射电通量**：2.8 GHz频率的真实测量值
- ⚡ **24小时耀斑概率**：
  - C级耀斑概率（小型）
  - M级耀斑概率（中型）
  - X级耀斑概率（大型）

### 📊 数据来源

您提供的数据来自：
- **NOAA Space Weather Prediction Center**
- **Boulder K-index** (地磁活动)
- **Solar Radio Observatories** (太阳射电通量)
- **SWPC Forecasts** (太阳活动预测)

---

## 🎯 数据说明

### 1. Kp指数数据
```json
{
  "time_tag": "2025-10-24T01:10:00",
  "k_index": 2.2
}
```
- **time_tag**: UTC时间戳
- **k_index**: 地磁指数 (0-9)
- **更新频率**: 每分钟

### 2. 太阳射电通量
```json
{
  "time_tag": "2025-10-24T22:54:00",
  "common_name": "Kaena Point",
  "details": [
    {
      "frequency": 2695,  // MHz (2.8 GHz)
      "flux": 122,        // Solar Flux Units (sfu)
      "observed_quality": "Good quality"
    }
  ]
}
```
- **频率**: 245-15400 MHz
- **通量单位**: sfu (10^-22 W/m²/Hz)
- **观测站**: Kaena Point, Sagamore Hill, San Vito

### 3. 太阳耀斑概率
```json
{
  "date": "2025-10-24T00:00:00",
  "c_class_1_day": 99,    // C级耀斑概率 (%)
  "m_class_1_day": 10,    // M级耀斑概率 (%)
  "x_class_1_day": 1,     // X级耀斑概率 (%)
  "polar_cap_absorption": "green"
}
```

---

## 🚀 如何运行

### 步骤1：确保数据文件在正确位置

数据文件应该在：
```
public/data/
├── boulder_k_index_1m.json
├── solar-radio-flux.json
└── solar_probabilities.json
```

### 步骤2：启动应用

```bash
npm run dev
```

### 步骤3：查看真实数据

应用启动后，在**Space Weather Panel**右上角会显示：
- 🟢 **Real Data** = 真实数据加载成功
- 🟡 **Simulated** = 使用模拟数据（数据加载失败）

---

## 📈 显示的真实数据

### 在Space Weather面板中：

```
☀️ Space Weather                    [🗄️ Real Data]

📊 Solar Activity: QUIET/ACTIVE/STORM
   (基于真实Kp指数)

💨 Solar Wind: XXX km/s
   (根据Kp指数计算)

📊 Kp Index: X.X
   [████████░░░░░░░░] (真实测量值)

🌟 Particle Flux:
   Proton: X.XXe+XX pfu
   Electron: X.XXe+XX e/cm²/s
   (基于Kp和射电通量估算)

📡 Solar Radio Flux (2.8 GHz): XXX sfu
   (真实测量值 - 新增)

⚡ 24h Flare Probability:
   C-Class: XX%  (真实预测)
   M-Class: X%   (真实预测)
   X-Class: X%   (真实预测)

Last updated: HH:MM:SS
```

---

## 🔄 数据更新频率

- **自动加载**: 应用启动时
- **自动刷新**: 每30秒更新一次
- **数据源**: 从`public/data/`文件夹读取

---

## 💡 数据解读

### Kp指数含义

| Kp值 | 等级 | 太阳风速度 | 对卫星影响 |
|------|------|-----------|-----------|
| 0-2 | 🟢 平静 | ~400 km/s | 无 |
| 3-4 | 🟡 不稳定 | ~500 km/s | 轻微 |
| 5-6 | 🟠 地磁暴 | ~600 km/s | **需要注意** |
| 7-9 | 🔴 强暴 | ~750 km/s | **高风险** |

### 太阳射电通量

- **正常值**: 70-150 sfu
- **活跃期**: 150-300 sfu
- **高活动**: >300 sfu

### 耀斑等级

- **C级**: 小型，很少影响
- **M级**: 中型，可能影响通信
- **X级**: 大型，严重影响卫星

---

## 🎨 视觉指示

### 数据来源标签

```
[🗄️ Real Data]  - 绿色 = 使用真实NOAA数据
[⚙️ Simulated]  - 黄色 = 使用模拟数据
```

### 警告触发条件

当检测到以下情况时显示警告：
- Kp指数 ≥ 6
- 或太阳活动等级为"storm"

```
⚠️ High Activity Detected
Increased radiation levels may affect satellite operations
```

---

## 🔧 扩展建议

### 如果需要更频繁的数据更新：

1. **连接实时API**
```typescript
// 在 realSpaceWeatherService.ts 中
async fetchLatestData() {
  const response = await fetch('https://services.swpc.noaa.gov/json/...')
  // 处理数据
}
```

2. **使用WebSocket**
```typescript
const ws = new WebSocket('wss://your-backend/space-weather')
ws.onmessage = (event) => {
  updateWeatherData(JSON.parse(event.data))
}
```

### 如果需要历史图表：

可以使用`realSpaceWeatherService.getKpHistory()`方法：
```typescript
const history = realSpaceWeatherService.getKpHistory(24)
// 用Recharts或其他库绘制图表
```

---

## ✅ 测试清单

- [x] 数据文件已放置在`public/data/`
- [x] 服务可以读取JSON文件
- [x] Space Weather Panel显示真实数据
- [x] 右上角显示"Real Data"标签
- [x] Kp指数来自真实数据
- [x] 太阳射电通量显示
- [x] 耀斑概率显示
- [x] 每30秒自动更新
- [x] 加载失败时回退到模拟数据

---

## 🎉 完成！

您的应用现在使用的是**真实的NOAA空间天气数据**！

**下一步**：
1. 运行 `npm run dev`
2. 查看Space Weather Panel
3. 确认显示"Real Data"
4. 观察真实的Kp指数和其他参数

---

## 🆕 新功能：真实碰撞检测数据

### ✅ 现已集成！

系统现在也支持**真实的碰撞检测数据**（来自Space-Track.org）！

#### 📋 已完成的升级：
1. ✅ **Space-Track.org API客户端** - 自动认证和数据获取
2. ✅ **真实CDM数据** - 未来7天碰撞预警
3. ✅ **增强的威胁监控** - 支持真实和模拟双模式
4. ✅ **数据源指示器** - 显示当前使用的数据源

#### 🚀 快速启用：

1. **注册账号**：https://www.space-track.org/auth/register

2. **配置环境**：
   ```bash
   # 复制配置模板
   copy ENV_CONFIG_TEMPLATE.txt .env
   
   # 编辑 .env，填入凭据
   VITE_SPACETRACK_USERNAME=你的用户名
   VITE_SPACETRACK_PASSWORD=你的密码
   VITE_USE_SIMULATION=false
   ```

3. **修改配置**（`src/config/api.config.ts`）：
   ```typescript
   export const USE_SIMULATION = false
   ```

4. **运行应用**：
   ```bash
   npm run dev
   ```

#### 📖 详细文档：
- 📘 **完整指南**：`真实碰撞检测数据集成指南.md`
- 🚀 **快速开始**：`REAL_DATA_QUICK_START.md`
- ⚙️ **环境配置**：`ENV_CONFIG_TEMPLATE.txt`

#### 🎯 功能对比：

| 功能 | 状态 | 数据源 |
|------|------|--------|
| 空间天气 | ✅ 真实数据 | NOAA |
| Kp地磁指数 | ✅ 真实数据 | NOAA |
| 太阳射电通量 | ✅ 真实数据 | NOAA |
| 耀斑概率 | ✅ 真实数据 | NOAA |
| **碰撞检测** | ✅ **真实数据** | **Space-Track.org** |
| 碰撞预警 | ✅ 真实数据 | Space-Track.org |
| 碰撞概率 | ✅ 真实数据 | Space-Track.org |
| TLE轨道数据 | ✅ 真实数据 | Space-Track.org |

#### ⚡ 查看效果：

在**Threat Monitor**面板右上角，你会看到数据源指示器：
- 🟢 **Real Data** = 使用真实数据
- 🟡 **Simulated** = 使用模拟数据

---

有任何问题随时告诉我！ 🚀

